<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Assignment 4</title>
    <link rel="stylesheet" href="normalize.css">
    <link rel="stylesheet" href="styles.css">
    <script src="d3.v4.min.js"></script>
  </head>
  <body>
	<div id="chart2"></div>
    <script>
      (function(d3) {
        'use strict';

        var dataset = [
          { label: 'Jan', additions: 1924, deletions: 1272 },
          { label: 'Feb', additions: 1746, deletions: 922 },
          { label: 'Mar', additions: 205, deletions: 157 },
          { label: 'Apr', additions: 1041, deletions: 229 },
          { label: 'May', additions: 278, deletions: 108 },
          { label: 'Jun', additions: 661, deletions: 238 },
        ];

		var margin = {left:10, right:10, top:5, bottom:30};
		var width = 600;
		var height = 400;
		var barwidth = 50;
		
		var y = d3.scaleLinear()
			.domain([0, d3.max(dataset.map(function(d) {return d.additions + d.deletions;}))])
			.range([0, height]);
		
		var x = d3.scaleBand()
			.range([0, width])
			.padding(0.3)
			.domain(dataset.map(function(d) {return d.label}));
		
		var xAxis = d3.axisBottom(x);
		var yAxis = d3.axisLeft(y);
		
		var svg = d3.select('#chart2')
			.append("svg")
			.attr("width", width + margin.left + margin.right)
			.attr("height", height + margin.top + margin.bottom)
			.append("g")
			.attr("transform", "translate(" + margin.left + ", " + margin.top + ")");
		
		svg.append("g")
		.attr("transform", "translate(0," + height + ")")
		.call(xAxis);
		
		svg.append("g")
		.call(yAxis);
		
		var g = svg
			.append("g");
			
        var barAdditions = g.selectAll("g")
			.data(dataset)
			.enter().append('rect')
			.attr("x", function(d) {return x(d.label)})
			.attr("height", function(d) {return y(d.additions)})
			.attr("y", function(d) {return (height - y(d.additions)) + "px";})
			.attr("width", x.bandwidth())
			.attr("fill","#22BB55");
			
		var barDeletions = g.selectAll("g")
			.data(dataset)
			.enter().append('rect')
			.attr("x", function(d) {return x(d.label)})
			.attr("y", function(d) {return (height - y(d.additions) - y(d.deletions)) + "px";})
			.attr("height", function(d) {return y(d.deletions)})
			.attr("width", x.bandwidth())
			.attr("fill","#EE3322");
			
		/*
        var barAdditions = g.selectAll("g")
			.data(dataset)
			.enter().append('rect')
			.attr("transform", function(d,i) {return "translate(" + i * (barwidth + margin.left + margin.right) + ", " + (height - y(d.additions)) + ")";})
			.attr("height", function(d) {return y(d.additions) + "px";})
			.attr("width", barwidth + "px")
			.attr("fill","#22BB55");
		
		var barDeletions = g.selectAll("g")
			.data(dataset)
			.enter().append('rect')
			.attr("transform", function(d,i) {return "translate(" + i * (barwidth + margin.left + margin.right) + ", " + (height - y(d.additions) - y(d.deletions)) + ")";})
			.attr("height", function(d) {return x(d.deletions) + "px";})
			.attr("width", barwidth + "px")
			.attr("fill","#EE3322");
		*/
		var tooltip = d3.select('#chart2').
			append('div')
			.attr('class','tooltip');
		
		tooltip.append('div')
			.attr('class', 'label');
		
		tooltip.append('div')
			.attr('class', 'additions');
			
		tooltip.append('div')
			.attr('class', 'deletions');
			
		barAdditions.on('mouseover', function(d) {
			tooltip.select('.label').html(d.label);
			tooltip.select('.additions').html(d.additions).style('font-weight', 'bold');
			tooltip.select('.deletions').html(d.deletions);
			tooltip.style('display', 'block');
		});
		
		barAdditions.on('mouseout', function(d) {
			tooltip.select('.additions').html(d.deletions).style('font-weight', 'normal');
			tooltip.style('display','none');
		});
		
		barDeletions.on('mouseover', function(d) {
			tooltip.select('.label').html(d.label);
			tooltip.select('.additions').html(d.additions);
			tooltip.select('.deletions').html(d.deletions).style('font-weight', 'bold');
			tooltip.style('display', 'block');
		});
		
		barDeletions.on('mouseout', function(d) {
			tooltip.select('.deletions').html(d.deletions).style('font-weight', 'normal');
			tooltip.style('display','none');
		});
      })(window.d3);
    </script>
  </body>
</html>
